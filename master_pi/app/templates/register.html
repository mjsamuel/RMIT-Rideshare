{% extends "layout.html" %}

{% block content %}
  <script>
    function submitClicked() {
      var data = {
        username: document.getElementById('username').value,
        f_name: document.getElementById('first-name').value,
        l_name: document.getElementById('last-name').value,
        email: document.getElementById('email').value,
        password: document.getElementById('password').value,
        confirm_password: document.getElementById('confirm-password').value
      }

      fetch('/api/user', {
          method: "POST",
          headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(data => {
          if (data.user != null) {
            sessionStorage.setItem('username', data.user.username);
            window.location.href = "/";
          } else {
            let errorBanner = document.getElementById("error-message");
            errors = outputErrors(data.message);
            errorBanner.innerHTML = errors;
            errorBanner.style.display = "block";
          }
        });
    }

    function cancelClicked() {
      window.location.href = "/login"
    }
  </script>

  <form>
    <div class="form-group">
      <input type="username" class="form-control" id="username" placeholder="Username"/>
    </div>
    <div class="form-group">
      <input type="text" class="form-control" id="first-name" placeholder="First Name"/>
    </div>
    <div class="form-group">
      <input type="text" class="form-control" id="last-name" placeholder="Last Name"/>
    </div>
    <div class="form-group">
      <input type="email" class="form-control" id="email" placeholder="Email"/>
    </div>
    <div class="form-group">
      <input type="password" class="form-control" id="password"  placeholder="Password"/>
    </div>
    <div class="form-group">
      <input type="password" class="form-control" id="confirm-password"  placeholder="Confirm Password"/>
    </div>

    <div class="alert alert-danger" id="error-message"></div>

    <div class="btn-group">
      <button type="button" class="btn btn-primary" onclick='submitClicked()'>Submit</button>
      <button type="button" class="btn btn-secondary" onclick='cancelClicked()'>Cancel</button>
    </div>
  </form>

{% endblock %}
